{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Dell\\\\OneDrive\\\\Desktop\\\\MySociety\\\\Frontend\\\\src\\\\pages\\\\Guard\\\\GuardCheckIn.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport api from '../../api/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GuardCheckIn = ({\n  action = 'checkin'\n}) => {\n  _s();\n  var _location$state;\n  const location = useLocation();\n  const navigate = useNavigate();\n  const [mode, setMode] = useState('approved');\n  const preApprovedVisitor = (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.visitor;\n  const [formData, setFormData] = useState({\n    visitorId: '',\n    name: '',\n    phone: '',\n    unitNumber: '',\n    vehicleNo: '',\n    visitorType: 'guest',\n    qrCodePlaceholder: ''\n  });\n\n  // New State for Resident Contact Lookup\n  const [residentContact, setResidentContact] = useState(null);\n  const [lookupLoading, setLookupLoading] = useState(false);\n  const [message, setMessage] = useState('');\n  const [error, setError] = useState('');\n  const [visitorIdToCheckout, setVisitorIdToCheckout] = useState('');\n\n  // Checkout page states\n  const [checkoutMode, setCheckoutMode] = useState('list'); // 'list' or 'manual'\n  const [checkedInVisitors, setCheckedInVisitors] = useState([]);\n  const [loadingVisitors, setLoadingVisitors] = useState(true);\n  useEffect(() => {\n    if (preApprovedVisitor) {\n      setFormData(prev => ({\n        ...prev,\n        visitorId: preApprovedVisitor._id,\n        name: preApprovedVisitor.name,\n        phone: preApprovedVisitor.phone,\n        unitNumber: preApprovedVisitor.unitNumber,\n        visitorType: preApprovedVisitor.visitorType\n      }));\n      setMessage(`Checking in Approved Visitor: ${preApprovedVisitor.name}`);\n    }\n  }, [preApprovedVisitor]);\n\n  // Fetch checked-in visitors for checkout page\n  useEffect(() => {\n    if (action === 'checkout') {\n      fetchCheckedInVisitors();\n    }\n  }, [action]);\n  const fetchCheckedInVisitors = async () => {\n    try {\n      setLoadingVisitors(true);\n      const res = await api.get('/visitors/guard/checked-in');\n      setCheckedInVisitors(res.data);\n    } catch (err) {\n      setError('Failed to load checked-in visitors.');\n    } finally {\n      setLoadingVisitors(false);\n    }\n  };\n  const handleChange = e => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  // --- NEW FUNCTION: LOOKUP RESIDENT ---\n  const handleLookupResident = async () => {\n    if (!formData.unitNumber) return;\n    setLookupLoading(true);\n    setResidentContact(null);\n    setError('');\n    try {\n      const res = await api.get(`/visitors/guard/lookup/${formData.unitNumber}`);\n      setResidentContact(res.data);\n    } catch (err) {\n      setResidentContact(null);\n      // Don't show error alert, just small text is better, but for now logging\n      console.log(\"Resident not found\");\n    } finally {\n      setLookupLoading(false);\n    }\n  };\n  const handleCheckInSubmit = async e => {\n    e.preventDefault();\n    setMessage('');\n    setError('');\n    const payload = preApprovedVisitor ? {\n      visitorId: preApprovedVisitor._id,\n      vehicleNo: formData.vehicleNo\n    } : formData;\n    try {\n      const res = await api.post('/visitors/guard/check-in', payload);\n      setMessage(`Success: Checked in ${res.data.visitor.name} to Villa ${res.data.visitor.unitNumber}.`);\n      setFormData({\n        visitorId: '',\n        name: '',\n        phone: '',\n        unitNumber: '',\n        vehicleNo: '',\n        visitorType: 'guest',\n        qrCodePlaceholder: ''\n      });\n      setTimeout(() => navigate('/guard/dashboard'), 1500);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Check-in failed.');\n    }\n  };\n  const handleRequestSubmit = async e => {\n    e.preventDefault();\n    setMessage('');\n    setError('');\n    try {\n      await api.post('/visitors/guard/request-entry', formData);\n      setMessage('Request sent to Resident! Ask visitor to wait. Check Dashboard for approval status.');\n      // Reset form but keep resident info visible for a moment\n      setFormData({\n        visitorId: '',\n        name: '',\n        phone: '',\n        unitNumber: '',\n        vehicleNo: '',\n        visitorType: 'guest',\n        qrCodePlaceholder: ''\n      });\n      setTimeout(() => setResidentContact(null), 5000);\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      setError(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || 'Failed to send request. Check Villa Number.');\n    }\n  };\n  const handleCheckOutSubmit = async e => {\n    e.preventDefault();\n    setMessage('');\n    setError('');\n    try {\n      const res = await api.post(`/visitors/guard/check-out/${visitorIdToCheckout}`);\n      setMessage(`Successfully checked out visitor ID: ${res.data.visitor._id}.`);\n      setVisitorIdToCheckout('');\n    } catch (err) {\n      var _err$response3, _err$response3$data;\n      setError(((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.message) || 'Check-out failed. Invalid ID or already checked out.');\n    }\n  };\n  if (action === 'checkout') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container mt-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Manual Visitor Check-Out\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleCheckOutSubmit,\n        className: \"card p-4 mx-auto\",\n        style: {\n          maxWidth: '500px'\n        },\n        children: [message && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"alert alert-success\",\n          children: message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 33\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"alert alert-danger\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 31\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"form-label\",\n            children: \"Visitor Record ID\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: visitorIdToCheckout,\n            onChange: e => setVisitorIdToCheckout(e.target.value),\n            required: true,\n            className: \"form-control\",\n            placeholder: \"Paste Visitor ID...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"btn btn-danger w-100\",\n          children: \"Check-Out Visitor\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mt-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Guard Gate Entry\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"btn-group mb-4 w-100\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: `btn ${mode === 'approved' ? 'btn-primary' : 'btn-outline-primary'}`,\n        onClick: () => setMode('approved'),\n        disabled: !!preApprovedVisitor,\n        children: \"Check-In (Approved)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `btn ${mode === 'request' ? 'btn-warning' : 'btn-outline-warning'}`,\n        onClick: () => setMode('request'),\n        disabled: !!preApprovedVisitor,\n        children: \"Request Entry (Sudden)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }, this), message && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert alert-info\",\n      children: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 25\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert alert-danger\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 23\n    }, this), mode === 'approved' ? /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleCheckInSubmit,\n      className: \"card p-4 mx-auto\",\n      style: {\n        maxWidth: '500px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Check-In Approved Visitor\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 21\n      }, this), preApprovedVisitor ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-success\",\n        children: [\"Selected: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: preApprovedVisitor.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 63\n        }, this), \" (Villa \", preApprovedVisitor.unitNumber, \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-muted\",\n          children: [\"Please select an approved visitor from the \", /*#__PURE__*/_jsxDEV(\"a\", {\n            href: \"/guard/dashboard\",\n            children: \"Dashboard\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 98\n          }, this), \" or enter ID manually.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"visitorId\",\n          value: formData.visitorId,\n          onChange: handleChange,\n          placeholder: \"Visitor ID\",\n          className: \"form-control mb-3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 26\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"form-label\",\n          children: \"Vehicle No (Optional)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"vehicleNo\",\n          value: formData.vehicleNo,\n          onChange: handleChange,\n          className: \"form-control\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-success w-100\",\n        children: \"Confirm Check-In\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleRequestSubmit,\n      className: \"card p-4 mx-auto border-warning\",\n      style: {\n        maxWidth: '500px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"text-warning\",\n        children: \"Request Sudden Entry\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-muted small\",\n        children: \"This will send a notification to the resident for approval.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"form-label\",\n          children: \"Villa No.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"input-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"unitNumber\",\n            value: formData.unitNumber,\n            onChange: handleChange,\n            required: true,\n            className: \"form-control\",\n            placeholder: \"Enter Villa No.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-outline-secondary\",\n            type: \"button\",\n            onClick: handleLookupResident,\n            children: \"\\uD83D\\uDD0D Check\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 25\n        }, this), lookupLoading && /*#__PURE__*/_jsxDEV(\"small\", {\n          className: \"text-muted\",\n          children: \"Looking up resident...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 43\n        }, this), residentContact && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"alert alert-secondary mt-2 p-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Owner:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 33\n          }, this), \" \", residentContact.name, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 79\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-grid gap-2 mt-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"a\", {\n              href: `tel:${residentContact.phone}`,\n              className: \"btn btn-sm btn-outline-success\",\n              children: [\"\\uD83D\\uDCDE Call Primary: \", residentContact.phone]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 37\n            }, this), residentContact.phoneSecondary && /*#__PURE__*/_jsxDEV(\"a\", {\n              href: `tel:${residentContact.phoneSecondary}`,\n              className: \"btn btn-sm btn-outline-success\",\n              children: [\"\\uD83D\\uDCDE Call Secondary: \", residentContact.phoneSecondary]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"form-label\",\n          children: \"Visitor Name\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"name\",\n          value: formData.name,\n          onChange: handleChange,\n          required: true,\n          className: \"form-control\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"form-label\",\n          children: \"Phone\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"phone\",\n          value: formData.phone,\n          onChange: handleChange,\n          required: true,\n          className: \"form-control\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"form-label\",\n          children: \"Vehicle No\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"vehicleNo\",\n          value: formData.vehicleNo,\n          onChange: handleChange,\n          className: \"form-control\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"form-label\",\n          children: \"Type\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          name: \"visitorType\",\n          value: formData.visitorType,\n          onChange: handleChange,\n          className: \"form-select\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"guest\",\n            children: \"Guest\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"delivery\",\n            children: \"Delivery\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"service\",\n            children: \"Service\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"other\",\n            children: \"Other\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-warning w-100\",\n        children: \"Send Approval Request\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 156,\n    columnNumber: 9\n  }, this);\n};\n_s(GuardCheckIn, \"KdYnseud02PU+XzYSE/JxIIJS+0=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c = GuardCheckIn;\nexport default GuardCheckIn;\nvar _c;\n$RefreshReg$(_c, \"GuardCheckIn\");","map":{"version":3,"names":["React","useState","useEffect","useLocation","useNavigate","api","jsxDEV","_jsxDEV","GuardCheckIn","action","_s","_location$state","location","navigate","mode","setMode","preApprovedVisitor","state","visitor","formData","setFormData","visitorId","name","phone","unitNumber","vehicleNo","visitorType","qrCodePlaceholder","residentContact","setResidentContact","lookupLoading","setLookupLoading","message","setMessage","error","setError","visitorIdToCheckout","setVisitorIdToCheckout","checkoutMode","setCheckoutMode","checkedInVisitors","setCheckedInVisitors","loadingVisitors","setLoadingVisitors","prev","_id","fetchCheckedInVisitors","res","get","data","err","handleChange","e","target","value","handleLookupResident","console","log","handleCheckInSubmit","preventDefault","payload","post","setTimeout","_err$response","_err$response$data","response","handleRequestSubmit","_err$response2","_err$response2$data","handleCheckOutSubmit","_err$response3","_err$response3$data","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","style","maxWidth","type","onChange","required","placeholder","onClick","disabled","href","phoneSecondary","_c","$RefreshReg$"],"sources":["C:/Users/Dell/OneDrive/Desktop/MySociety/Frontend/src/pages/Guard/GuardCheckIn.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport api from '../../api/api';\r\n\r\nconst GuardCheckIn = ({ action = 'checkin' }) => {\r\n    const location = useLocation();\r\n    const navigate = useNavigate();\r\n    const [mode, setMode] = useState('approved'); \r\n    const preApprovedVisitor = location.state?.visitor;\r\n\r\n    const [formData, setFormData] = useState({\r\n        visitorId: '', \r\n        name: '',\r\n        phone: '',\r\n        unitNumber: '',\r\n        vehicleNo: '',\r\n        visitorType: 'guest',\r\n        qrCodePlaceholder: ''\r\n    });\r\n    \r\n    // New State for Resident Contact Lookup\r\n    const [residentContact, setResidentContact] = useState(null);\r\n    const [lookupLoading, setLookupLoading] = useState(false);\r\n\r\n    const [message, setMessage] = useState('');\r\n    const [error, setError] = useState('');\r\n    const [visitorIdToCheckout, setVisitorIdToCheckout] = useState('');\r\n    \r\n    // Checkout page states\r\n    const [checkoutMode, setCheckoutMode] = useState('list'); // 'list' or 'manual'\r\n    const [checkedInVisitors, setCheckedInVisitors] = useState([]);\r\n    const [loadingVisitors, setLoadingVisitors] = useState(true);\r\n\r\n    useEffect(() => {\r\n        if (preApprovedVisitor) {\r\n            setFormData(prev => ({\r\n                ...prev,\r\n                visitorId: preApprovedVisitor._id,\r\n                name: preApprovedVisitor.name,\r\n                phone: preApprovedVisitor.phone,\r\n                unitNumber: preApprovedVisitor.unitNumber,\r\n                visitorType: preApprovedVisitor.visitorType,\r\n            }));\r\n            setMessage(`Checking in Approved Visitor: ${preApprovedVisitor.name}`);\r\n        }\r\n    }, [preApprovedVisitor]);\r\n\r\n    // Fetch checked-in visitors for checkout page\r\n    useEffect(() => {\r\n        if (action === 'checkout') {\r\n            fetchCheckedInVisitors();\r\n        }\r\n    }, [action]);\r\n\r\n    const fetchCheckedInVisitors = async () => {\r\n        try {\r\n            setLoadingVisitors(true);\r\n            const res = await api.get('/visitors/guard/checked-in');\r\n            setCheckedInVisitors(res.data);\r\n        } catch (err) {\r\n            setError('Failed to load checked-in visitors.');\r\n        } finally {\r\n            setLoadingVisitors(false);\r\n        }\r\n    };\r\n\r\n    const handleChange = (e) => {\r\n        setFormData({ ...formData, [e.target.name]: e.target.value });\r\n    };\r\n\r\n    // --- NEW FUNCTION: LOOKUP RESIDENT ---\r\n    const handleLookupResident = async () => {\r\n        if(!formData.unitNumber) return;\r\n        setLookupLoading(true);\r\n        setResidentContact(null);\r\n        setError('');\r\n        \r\n        try {\r\n            const res = await api.get(`/visitors/guard/lookup/${formData.unitNumber}`);\r\n            setResidentContact(res.data);\r\n        } catch (err) {\r\n            setResidentContact(null);\r\n             // Don't show error alert, just small text is better, but for now logging\r\n             console.log(\"Resident not found\");\r\n        } finally {\r\n            setLookupLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleCheckInSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setMessage('');\r\n        setError('');\r\n\r\n        const payload = preApprovedVisitor ? \r\n            { visitorId: preApprovedVisitor._id, vehicleNo: formData.vehicleNo } : \r\n            formData; \r\n\r\n        try {\r\n            const res = await api.post('/visitors/guard/check-in', payload);\r\n            setMessage(`Success: Checked in ${res.data.visitor.name} to Villa ${res.data.visitor.unitNumber}.`);\r\n            setFormData({ visitorId: '', name: '', phone: '', unitNumber: '', vehicleNo: '', visitorType: 'guest', qrCodePlaceholder: '' });\r\n            setTimeout(() => navigate('/guard/dashboard'), 1500);\r\n        } catch (err) {\r\n            setError(err.response?.data?.message || 'Check-in failed.');\r\n        }\r\n    };\r\n\r\n    const handleRequestSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setMessage('');\r\n        setError('');\r\n        \r\n        try {\r\n            await api.post('/visitors/guard/request-entry', formData);\r\n            setMessage('Request sent to Resident! Ask visitor to wait. Check Dashboard for approval status.');\r\n            // Reset form but keep resident info visible for a moment\r\n            setFormData({ visitorId: '', name: '', phone: '', unitNumber: '', vehicleNo: '', visitorType: 'guest', qrCodePlaceholder: '' });\r\n            setTimeout(() => setResidentContact(null), 5000);\r\n        } catch (err) {\r\n            setError(err.response?.data?.message || 'Failed to send request. Check Villa Number.');\r\n        }\r\n    };\r\n    \r\n    const handleCheckOutSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setMessage('');\r\n        setError('');\r\n        try {\r\n            const res = await api.post(`/visitors/guard/check-out/${visitorIdToCheckout}`);\r\n            setMessage(`Successfully checked out visitor ID: ${res.data.visitor._id}.`);\r\n            setVisitorIdToCheckout('');\r\n        } catch (err) {\r\n            setError(err.response?.data?.message || 'Check-out failed. Invalid ID or already checked out.');\r\n        }\r\n    };\r\n\r\n    if (action === 'checkout') {\r\n        return (\r\n            <div className=\"container mt-4\">\r\n                <h2>Manual Visitor Check-Out</h2>\r\n                <form onSubmit={handleCheckOutSubmit} className=\"card p-4 mx-auto\" style={{ maxWidth: '500px' }}>\r\n                    {message && <div className=\"alert alert-success\">{message}</div>}\r\n                    {error && <div className=\"alert alert-danger\">{error}</div>}\r\n                    <div className=\"mb-3\">\r\n                        <label className=\"form-label\">Visitor Record ID</label>\r\n                        <input type=\"text\" value={visitorIdToCheckout} onChange={(e) => setVisitorIdToCheckout(e.target.value)} required className=\"form-control\" placeholder=\"Paste Visitor ID...\" />\r\n                    </div>\r\n                    <button type=\"submit\" className=\"btn btn-danger w-100\">Check-Out Visitor</button>\r\n                </form>\r\n            </div>\r\n        );\r\n    }\r\n    \r\n    return (\r\n        <div className=\"container mt-4\">\r\n            <h2>Guard Gate Entry</h2>\r\n\r\n            <div className=\"btn-group mb-4 w-100\">\r\n                <button \r\n                    className={`btn ${mode === 'approved' ? 'btn-primary' : 'btn-outline-primary'}`} \r\n                    onClick={() => setMode('approved')}\r\n                    disabled={!!preApprovedVisitor} \r\n                >\r\n                    Check-In (Approved)\r\n                </button>\r\n                <button \r\n                    className={`btn ${mode === 'request' ? 'btn-warning' : 'btn-outline-warning'}`} \r\n                    onClick={() => setMode('request')}\r\n                    disabled={!!preApprovedVisitor}\r\n                >\r\n                    Request Entry (Sudden)\r\n                </button>\r\n            </div>\r\n\r\n            {message && <div className=\"alert alert-info\">{message}</div>}\r\n            {error && <div className=\"alert alert-danger\">{error}</div>}\r\n\r\n            {mode === 'approved' ? (\r\n                <form onSubmit={handleCheckInSubmit} className=\"card p-4 mx-auto\" style={{ maxWidth: '500px' }}>\r\n                    <h4>Check-In Approved Visitor</h4>\r\n                    {preApprovedVisitor ? (\r\n                        <p className=\"text-success\">Selected: <strong>{preApprovedVisitor.name}</strong> (Villa {preApprovedVisitor.unitNumber})</p>\r\n                    ) : (\r\n                         <div className=\"mb-3\">\r\n                            <p className=\"text-muted\">Please select an approved visitor from the <a href=\"/guard/dashboard\">Dashboard</a> or enter ID manually.</p>\r\n                            <input type=\"text\" name=\"visitorId\" value={formData.visitorId} onChange={handleChange} placeholder=\"Visitor ID\" className=\"form-control mb-3\" />\r\n                         </div>\r\n                    )}\r\n\r\n                    <div className=\"mb-3\">\r\n                        <label className=\"form-label\">Vehicle No (Optional)</label>\r\n                        <input type=\"text\" name=\"vehicleNo\" value={formData.vehicleNo} onChange={handleChange} className=\"form-control\" />\r\n                    </div>\r\n                    \r\n                    <button type=\"submit\" className=\"btn btn-success w-100\">Confirm Check-In</button>\r\n                </form>\r\n            ) : (\r\n                <form onSubmit={handleRequestSubmit} className=\"card p-4 mx-auto border-warning\" style={{ maxWidth: '500px' }}>\r\n                    <h4 className=\"text-warning\">Request Sudden Entry</h4>\r\n                    <p className=\"text-muted small\">This will send a notification to the resident for approval.</p>\r\n                    \r\n                    <div className=\"mb-3\">\r\n                        <label className=\"form-label\">Villa No.</label>\r\n                        <div className=\"input-group\">\r\n                            <input \r\n                                type=\"text\" \r\n                                name=\"unitNumber\" \r\n                                value={formData.unitNumber} \r\n                                onChange={handleChange} \r\n                                required \r\n                                className=\"form-control\" \r\n                                placeholder=\"Enter Villa No.\"\r\n                            />\r\n                            <button className=\"btn btn-outline-secondary\" type=\"button\" onClick={handleLookupResident}>\r\n                                üîç Check\r\n                            </button>\r\n                        </div>\r\n                        {/* --- CONTACT DETAILS DISPLAY --- */}\r\n                        {lookupLoading && <small className=\"text-muted\">Looking up resident...</small>}\r\n                        {residentContact && (\r\n                            <div className=\"alert alert-secondary mt-2 p-2\">\r\n                                <strong>Owner:</strong> {residentContact.name}<br/>\r\n                                <div className=\"d-grid gap-2 mt-2\">\r\n                                    <a href={`tel:${residentContact.phone}`} className=\"btn btn-sm btn-outline-success\">\r\n                                        üìû Call Primary: {residentContact.phone}\r\n                                    </a>\r\n                                    {residentContact.phoneSecondary && (\r\n                                        <a href={`tel:${residentContact.phoneSecondary}`} className=\"btn btn-sm btn-outline-success\">\r\n                                            üìû Call Secondary: {residentContact.phoneSecondary}\r\n                                        </a>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                        {/* ------------------------------- */}\r\n                    </div>\r\n                    \r\n                    <div className=\"mb-3\">\r\n                        <label className=\"form-label\">Visitor Name</label>\r\n                        <input type=\"text\" name=\"name\" value={formData.name} onChange={handleChange} required className=\"form-control\" />\r\n                    </div>\r\n                    <div className=\"mb-3\">\r\n                        <label className=\"form-label\">Phone</label>\r\n                        <input type=\"text\" name=\"phone\" value={formData.phone} onChange={handleChange} required className=\"form-control\" />\r\n                    </div>\r\n                    <div className=\"mb-3\">\r\n                        <label className=\"form-label\">Vehicle No</label>\r\n                        <input type=\"text\" name=\"vehicleNo\" value={formData.vehicleNo} onChange={handleChange} className=\"form-control\" />\r\n                    </div>\r\n                    <div className=\"mb-3\">\r\n                        <label className=\"form-label\">Type</label>\r\n                        <select name=\"visitorType\" value={formData.visitorType} onChange={handleChange} className=\"form-select\">\r\n                            <option value=\"guest\">Guest</option>\r\n                            <option value=\"delivery\">Delivery</option>\r\n                            <option value=\"service\">Service</option>\r\n                            <option value=\"other\">Other</option>\r\n                        </select>\r\n                    </div>\r\n                    \r\n                    <button type=\"submit\" className=\"btn btn-warning w-100\">Send Approval Request</button>\r\n                </form>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default GuardCheckIn;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}